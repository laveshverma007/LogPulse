<!DOCTYPE html>
<html>
<head>
    <title>DataFrame Table</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://cdn.datatables.net/autofill/2.3.10/js/dataTables.autoFill.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div class="px-6 py-12 mx-auto max-w-8xl">
        <h1 class="text-4xl font-bold text-red-700 mb-8">Overall Analysis</h1>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <!-- Total Requests Card -->
            <div class="bg-white rounded-lg shadow-md p-4 space-y-2">
                <span class="text-gray-600 font-semibold">Total Requests</span>
                <span class="font-semibold text-gray-900 block text-3xl">{{ total_requests }}</span>
            </div>
    
            <!-- Valid Requests Card -->
            <div class="bg-white rounded-lg shadow-md p-4 space-y-2">
                <span class="text-gray-600 font-semibold">Valid Requests</span>
                <span class="font-semibold text-green-600 block text-3xl">{{ valid_requests }}</span>
            </div>
    
            <!-- Failed Requests Card -->
            <div class="bg-white rounded-lg shadow-md p-4 space-y-2">
                <span class="text-gray-600 font-semibold">Failed Requests</span>
                <span class="font-semibold text-red-600 block text-3xl">{{ failed_requests }}</span>
            </div>
    
            <!-- Unique Visitors Card -->
            <div class="bg-white rounded-lg shadow-md p-4 space-y-2">
                <span class="text-gray-600 font-semibold">Unique Visitors</span>
                <span class="font-semibold text-indigo-600 block text-3xl">{{ unique_visitors }}</span>
            </div>
    
            <!-- Number of Requested Files Card -->
            <div class="bg-white rounded-lg shadow-md p-4 space-y-2">
                <span class="text-gray-600 font-semibold">Number of Requested Files</span>
                <span class="font-semibold text-blue-600 block text-3xl">{{ num_requested_files }}</span>
            </div>
    
            <!-- Referrers Card (if available) -->
            {% if referrers != "" %}
            <div class="bg-white rounded-lg shadow-md p-4 space-y-2">
                <span class="text-gray-600 font-semibold">Referrers</span>
                <span class="font-semibold text-purple-600 block text-3xl">{{ referrers }}</span>
            </div>
            {% endif %}
    
            <!-- Log Size Card -->
            <div class="bg-white rounded-lg shadow-md p-4 space-y-2">
                <span class="text-gray-600 font-semibold">Log Size</span>
                <span class="font-semibold text-yellow-600 block text-3xl">{{ log_size }} bytes</span>
            </div>
        </div>

        
        <div class="bg-white rounded-lg shadow-md p-6 mt-8 overflow-x-auto">
            <h2 class="text-2xl font-semibold text-gray-900 mb-4">Data Table</h2>
            <table id="logs_table" class="table table-striped table-bordered">
                <thead>
                    <tr>
                        {% for column in columns %}
                        <th id='{{column}}' class="px-6 py-3 bg-gray-200 text-left text-xs leading-4 font-medium text-gray-700 uppercase tracking-wider">
                            {{ column }}
                        </th>
                        {% endfor %}
                    </tr>
                </thead>
            </table>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6 mt-8">
            <h2 class="text-2xl font-semibold text-gray-900 mb-4">Visitors Per Hour</h2>
            <div id="chart"></div>
        </div>
    </div>

    <script>
        // Load the Plotly graph from JSON and display it in the "chart" div
        var chartData = {{ chart|safe }};
        Plotly.newPlot('chart', chartData);
    </script>
    <script>
        $(document).ready(function () {
            $('#logs_table').DataTable({
                data: {{ data|safe }},
                columns: [
                    {% for column in columns %}
                    { data: '{{ column }}'},
                    {% endfor %}
                ],
                // You can configure DataTables options here
                paging: true,
                searching: true,
                ordering: true,
                info: true,
                lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "All"]],
                dom: '<"flex p-4 justify-between items-center space-x-4"<"my-custom-searchbox"f><"my-custom-length"l>><t<"bottom"p>>',
                drawCallback: function () {
                    var cells = document.querySelectorAll('#logs_table tbody tr');

                    // Loop through each cell and add the "inline" class
                    cells.forEach(function (cell) {
                        cell.classList.add('whitespace-nowrap','m-4','p-4');
                    });
                       
                     table.columns().every(function () {
                        this.autoFill();
                    });
                }
            });
        });
    </script>
</body>
</html>
